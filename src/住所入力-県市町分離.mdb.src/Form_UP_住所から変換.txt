Version =19
VersionRequired =19
Checksum =-2021420509
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularCharSet =128
    TabularFamily =50
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =4762
    DatasheetFontHeight =9
    ItemSuffix =5
    Left =465
    Top =540
    Right =5490
    Bottom =2700
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xca86213aaba7e140
    End
    GUID = Begin
        0x12d0e9087ad91a458c80f951a10a24f7
    End
    NameMap = Begin
        0x0acc0e55000000007b932c32afb6dc4bbed74248f6e3b35900000000ae294175 ,
        0xc3f7e440000000000000000055005f00530075006200000000000000480d57bd ,
        0x85ed1045a0c40cd22a8fcc2b070000007b932c32afb6dc4bbed74248f6e3b359 ,
        0x0c7700000000000052438ffe18266b4aa63fcd3b49f56e3e070000007b932c32 ,
        0xafb6dc4bbed74248f6e3b3593057df57000000000000b6aa2f7f543e1c4ea63f ,
        0xcb4916685d04070000007b932c32afb6dc4bbed74248f6e3b359025e00000000 ,
        0x00003e6f5008ad97344aaf8923104167c548070000007b932c32afb6dc4bbed7 ,
        0x4248f6e3b35953006800690052000000000000005a5b331a5e397742af7edc8c ,
        0xc43a54440000000077655275c3f7e440000000000000000055005f006a75f753 ,
        0x00000000000012a6b8b428b4b345a1d99034617815a7070000005a5b331a5e39 ,
        0x7742af7edc8cc43a54443a75000000000000edd5233e22a3314fae47f3bda419 ,
        0xd843070000005a5b331a5e397742af7edc8cc43a54443a755200000000000000 ,
        0xdc00a7434bae1c4fb4bd4d6def2c8ab0070000005a5b331a5e397742af7edc8c ,
        0xc43a54445500370000000000000057262d6e5af8844bb865fe90d80ebd950700 ,
        0x00005a5b331a5e397742af7edc8cc43a54440c77000000000000c519eaa581d1 ,
        0xb447bf214ee5c8e52957070000005a5b331a5e397742af7edc8cc43a5444025e ,
        0x00000000000058393f9c7ec2524384ea90e7134f7bd1070000005a5b331a5e39 ,
        0x7742af7edc8cc43a54444b0065006e0052000000000000005b53015903adde47 ,
        0x945ace04907a4f63070000005a5b331a5e397742af7edc8cc43a544453006800 ,
        0x69005200000000000000abb93b6a43f45346bc1d74553a7ed1f8070000005a5b ,
        0x331a5e397742af7edc8cc43a54443057df570000000000000000000000000000 ,
        0x00000000000000000c000000050000000000000000000000000000000000
    End
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="ÇlÇr ÇoÉSÉVÉbÉN"
    PrtMip = Begin
        0xa3050000a1050000a1050000a105000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0022fb180900000053c716660020fb180e010000090000002c542e01fe28da18 ,
        0x010403069c00b0040f9b8007010009009a0b3408640001000700580202000100 ,
        0x580203000000413400b3d2290100000050b2e277db09e27730ce7a17908d3a01 ,
        0xf86e5f17e68a0000000000000000000000000000010000000000000001000000 ,
        0x0200000003010000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200380294041c00105a71740000000000000000000000000000000000000000 ,
        0x0000000000000000140000000100000000000100000000000000000000000100 ,
        0x0100010000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000038020000534d544a ,
        0x00000000100028027b00360036004300430036003800460034002d0035003200 ,
        0x420045002d0034003800310039002d0039004100410031002d00390039004400 ,
        0x3400420039003300390037003600390045007d000000496e70757442696e0054 ,
        0x7261793100524553444c4c00556e69726573444c4c004d656469615479706500 ,
        0x506c61696e00506170657253697a65004c4554544552004f7269656e74617469 ,
        0x6f6e00504f525452414954004475706c6578004e4f4e4500436f6c6f724d6f64 ,
        0x6500436f6c6f720050616765436f6c6f724d6f6465004e6f726d616c00506167 ,
        0x65437573746f6d48616c66746f6e6500446966667573696f6e005265736f6c75 ,
        0x74696f6e004f7074696f6e32005072696e745175616c697479004e6f726d616c ,
        0x005061676542696469725072696e74004f6e00436f6c6c617465004f46460052 ,
        0x6576657273654f72646572004f6666004a6f624e5570416c6c446f63756d656e ,
        0x7473436f6e746967756f75736c790031004a6f6250726573656e746174696f6e ,
        0x446972656374696f6e005269676874426f74746f6d00506167654272506f7374 ,
        0x6572004e6f726d616c0050616765427257617465726d61726b004e6f6e65004d ,
        0x6972726f72004f6666005061676552657665727365496d616765004f66660000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000001c0000005634444d0100000000000000 ,
        0x000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800260040000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3139322e3136382e322e31303000
    End
    OnActivate ="[Event Procedure]"
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Rectangle
            BorderLineStyle =0
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            TextFontCharSet =128
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =9
            FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
        End
        Begin ComboBox
            BorderLineStyle =0
        End
        Begin Section
            Height =1701
            BackColor =-2147483633
            Name ="è⁄ç◊"
            GUID = Begin
                0xac8ab215f791e44a94378ee96789bd56
            End
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =93
                    TextFontCharSet =128
                    TextFontFamily =50
                    IMEMode =1
                    Left =1072
                    Top =570
                    Width =1247
                    FontSize =9
                    TabIndex =1
                    BackColor =13692119
                    ForeColor =-2147483640
                    ColumnInfo ="\"\";\"\";\"10\";\"200\""
                    GUID = Begin
                        0x76768cb3f569194bb76376d96b332310
                    End
                    Name ="åßSelect"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW U_Sub.åß FROM U_Sub GROUP BY U_Sub.åß ORDER BY Min(U_Sub.ínàÊ); "
                    AfterUpdate ="[Event Procedure]"
                    OnEnter ="[Event Procedure]"
                    FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                    OnKeyDown ="[Event Procedure]"
                    ControlTipText ="Ç±ÇÃì¸óÕóìÇ≈ÇÕóXï÷î‘çÜÇãLì¸ÇµÇƒÇ¢Ç»Ç¢éûÇ…èZèäÇ©ÇÁóXï÷î‘çÜÇíTÇµÇƒì¸óÕÇ∑ÇÈéñÇ™Ç≈Ç´Ç‹Ç∑ÅB"
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =93
                            TextFontCharSet =128
                            TextAlign =1
                            TextFontFamily =50
                            Left =680
                            Top =569
                            Width =285
                            Height =225
                            FontSize =9
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="ÉâÉxÉã29"
                            Caption ="åß"
                            FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                            GUID = Begin
                                0x09dd41ec8acef146b3f5c9f8ee56618d
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    AutoExpand = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =2
                    OverlapFlags =93
                    TextFontCharSet =128
                    TextFontFamily =50
                    IMEMode =1
                    ColumnCount =3
                    ListRows =15
                    ListWidth =5670
                    Left =1072
                    Top =910
                    Width =2789
                    FontSize =9
                    TabIndex =2
                    BoundColumn =1
                    BackColor =13692119
                    ForeColor =-2147483640
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"200\""
                    GUID = Begin
                        0x61cf25b9822fc44ab077b799c9bf65d2
                    End
                    Name ="ésSelect"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW U_Sub.és, U_Sub.ínàÊ, U_Sub.ShiR FROM U_Sub; "
                    ColumnWidths ="2835;0;2835"
                    AfterUpdate ="[Event Procedure]"
                    OnEnter ="[Event Procedure]"
                    FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                    OnKeyDown ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    BaseInfo ="\"SELECT DISTINCTROW U_Sub.és, U_Sub.ínàÊ, U_Sub.ShiR FROM U_Sub; \";\"U_Sub\";\"\""
                        ";\"ínàÊ\";\"és\";\"PrimaryKey\""
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =93
                            TextFontCharSet =128
                            TextAlign =1
                            TextFontFamily =50
                            Left =510
                            Top =900
                            Width =510
                            Height =225
                            FontSize =9
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="ÉâÉxÉã31"
                            Caption ="és•ãÊ"
                            FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                            GUID = Begin
                                0x8a0af8e4608c0846958c94e7a431dd3d
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    AutoExpand = NotDefault
                    TabStop = NotDefault
                    SpecialEffect =2
                    OverlapFlags =93
                    TextFontCharSet =128
                    TextFontFamily =50
                    IMEMode =1
                    ColumnCount =7
                    ListRows =12
                    ListWidth =5670
                    Left =1072
                    Top =1251
                    Width =3402
                    FontSize =9
                    TabIndex =3
                    BackColor =13692119
                    ForeColor =-2147483640
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"1"
                        "48\""
                    GUID = Begin
                        0x19c8ddc5e65279478619d2b0217df354
                    End
                    Name ="Town"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW U_î‘çÜ.í¨, U_î‘çÜ.í¨R, U_î‘çÜ.U7, U_î‘çÜ.åß, U_î‘çÜ.és, U_î‘çÜ.KenR, U_î‘çÜ.Shi"
                        "R FROM U_î‘çÜ WHERE (((U_î‘çÜ.ínàÊ)=[ésSelect])); "
                    ColumnWidths ="2268;3402;0;0;0;1134;1134"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                    OnNotInList ="[Event Procedure]"
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =93
                            TextFontCharSet =128
                            TextAlign =1
                            TextFontFamily =50
                            Left =680
                            Top =1250
                            Width =240
                            Height =225
                            FontSize =9
                            BackColor =-2147483633
                            ForeColor =-2147483630
                            Name ="ÉâÉxÉã33"
                            Caption ="í¨"
                            FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                            GUID = Begin
                                0x65f627190f15694f88ef68724b79ff30
                            End
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =3
                    BackStyle =0
                    OverlapFlags =255
                    Left =510
                    Top =399
                    Width =4082
                    Height =1248
                    Name ="É{ÉbÉNÉX78"
                    GUID = Begin
                        0x78fe7ea3b6a6964fac9b4394019c47c2
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    FELineBreak = NotDefault
                    OverlapFlags =255
                    IMEMode =1
                    Left =2608
                    Top =570
                    Width =1881
                    Height =280
                    TabIndex =4
                    BackColor =13692119
                    Name ="èZèäåüçı"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="åßÇëIëÇ∑ÇÈÇ∆åüçıÇ™ëÅÇ≠Ç»ÇËÇ‹Ç∑"
                    GUID = Begin
                        0x5d5ffa515201a64cbaa3b2b43f07e159
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =255
                    TextFontCharSet =128
                    TextFontFamily =50
                    Left =2612
                    Top =396
                    Width =1665
                    Height =195
                    Name ="ÉâÉxÉã106"
                    Caption ="èZèäÇÃàÍïîÇ©ÇÁåüçı"
                    FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                    GUID = Begin
                        0xf11d66a2497cd947abfcc23d8d4b5c81
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =119
                    TextFontCharSet =128
                    TextFontFamily =50
                    Left =390
                    Top =60
                    Width =3075
                    Height =330
                    FontSize =14
                    FontWeight =700
                    Name ="ÉâÉxÉã0"
                    Caption ="óXï÷î‘çÜ èZèäÇ©ÇÁïœä∑"
                    FontName ="ÇlÇr ÇoÉSÉVÉbÉN"
                    GUID = Begin
                        0xea03520e4aa0664a8928efcaa25405eb
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =4762
                    Top =1474
                    Width =0
                    Height =0
                    Name ="ÉeÉLÉXÉg1"
                    BeforeUpdate ="[Event Procedure]"
                    OnEnter ="[Event Procedure]"
                    GUID = Begin
                        0x62b377353efaa84e834ead73dd032d2b
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Dim db As Database


Private Sub ÉeÉLÉXÉg1_Enter()
' É}ÉCÉNÉçÉ\ÉtÉgÇÃÉTÉ|Å[ÉgÇÃÉyÅ[ÉWÇÊÇË
' http://www.microsoft.com/mscorp/worldwide/japan/support/kb/articles/j022/4/19.htm
'[AC95] ÉtÉHÅ[ÉÄÇäJÇ≠ÉCÉxÉìÉgÇ…ÇÊÇ¡Çƒäøéöïœä∑Ç™ñ≥å¯Ç…Ç»ÇÈ
'ç≈èIçXêVì˙: 96/03/11
'ï∂èëî‘çÜ: J022419
    SendKeys "{enter}", False
'Ç‹Ç∏Ç±ÇÃÉtÉHÅ[ÉÄÇäJÇ≠Ç∆Ç±ÇÃÉeÉLÉXÉgÉ{ÉbÉNÉXÇ…ÉtÉHÅ[ÉJÉXÇ™à⁄ÇÈ
'éüÇ… é©ìÆìIÇ… {Enter} ÇâüÇµÇƒéüÇÃÉeÉLÉXÉgÉ{ÉbÉNÉXÇ…ÉtÉHÅ[ÉJÉXÇà⁄ìÆÇ∑ÇÈ
'Ç«ÇÃÇÊÇ§Ç»ÉvÉçÉOÉâÉÄÇ©ÇÁåƒÇ—èoÇ≥ÇÍÇƒÇ‡ëŒâûÇ≈Ç´ÇÈÇÊÇ§Ç»ÉvÉçÉOÉâÉÄ
End Sub

Private Sub Form_Close()
    db.Close
End Sub

Private Sub Form_Open(Cancel As Integer)
    Set db = CurrentDb
End Sub

Private Sub åßSelect_AfterUpdate()
    Dim sql As String
    
    sql = "SELECT DISTINCTROW U_Sub.és, U_Sub.ínàÊ, U_Sub.ShiR FROM U_Sub"

    If Len(Me.åßSelect) > 0 Then
        sql = sql & " WHERE (U_Sub.åß)='" & Me.åßSelect.Value & "'"
    End If
        
    Me.ésSelect.RowSource = sql
    With ésSelect
        .SetFocus
    End With

End Sub

Private Sub åßSelect_Enter()
    'Ç±Ç±Ç…à⁄Ç¡ÇΩÇ∆Ç´Ç…àÍéûìIÇ…ésSelectÇ…ÉtÉHÅ[ÉJÉXÇÃà⁄ìÆÇÇ≈Ç´ÇÈÇÊÇ§Ç…Ç∑ÇÈ
    Me![ésSelect].TabStop = True
End Sub

Private Sub åßSelect_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = 27 Then
        èZèäÇ©ÇÁïœä∑ÇÃèIóπ
    End If

End Sub

Private Sub ésSelect_AfterUpdate()
    With Town
        .Requery
        .SetFocus
        .Dropdown
    End With

End Sub

Private Sub ésSelect_Enter()
   Me![ésSelect].TabStop = False
'   Me![ésSelect].Dropdown
'çÇë¨Ç…åüçıÇ∑ÇÈÇΩÇﬂÇÃçHïv
'é©ìÆägí£ÇµÇ»Ç¢ÇÊÇ§Ç…Ç∑ÇÈ
End Sub

Private Sub ésSelect_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = 27 Then
        èZèäÇ©ÇÁïœä∑ÇÃèIóπ
    End If

End Sub

Private Sub ésSelect_NotInList(NewData As String, Response As Integer)
Dim sql As String

'ésÇÃñºèÃÇ™Ç‹ÇæíZÇ¢éû
    sql = "SELECT DISTINCTROW U_Sub.és, U_Sub.ínàÊ, U_Sub.ShiR FROM U_Sub"
         
    If Len(Me.åßSelect) > 0 Then
        sql = sql & " where (U_Sub.åß)='" & Me.åßSelect.Value & "'"
    ElseIf Len(NewData) > 0 Then
        sql = sql & " WHERE (U_Sub.és) Like '*" & NewData & "*'"
    End If
            
    Me.ésSelect.RowSource = sql
        
    Response = acDataErrContinue
    Me.[ésSelect].Dropdown

End Sub

Private Sub Town_AfterUpdate()
    Dim åß As String, és As String, í¨ As String, èZèä As String, i As Integer
    Dim KenR As String, ShiR As String, MachiR As String, JyuR As String
    Dim IsLoad As Integer
    
    If Not IsEmpty(Town) Then
        åß = Me![Town].Column(3)
        és = Me![Town].Column(4)
        í¨ = Me![Town].Column(0)
        KenR = Me![Town].Column(5)
        ShiR = Me![Town].Column(6)
        MachiR = Me![Town].Column(1)
        
        If Left(í¨, 5) = "à»â∫Ç…åfç⁄" Then ' èZèäñºÇ™à»â∫Ç…åfç⁄ÇÃÇ»Ç¢èÍçáÇÃéû
            'í¨ÇÃñºëOÇì¸ÇÍÇ»Ç¢
            If Left(åß, 2) = Left(és, 2) Then       'åßñºÇ∆ésñºÇ™ìØÇ∂Ç»ÇÁésÇ©ÇÁï\é¶
                èZèä = és
                JyuR = ShiR
            Else
                èZèä = åß & és
                JyuR = KenR & " " & ShiR
            End If
        Else
            If Left(åß, 2) = Left(és, 2) Then       'åßñºÇ∆ésñºÇ™ìØÇ∂Ç»ÇÁésÇ©ÇÁï\é¶
                èZèä = és & í¨
                JyuR = ShiR & " " & MachiR
            Else
                èZèä = åß & és & í¨
                JyuR = KenR & " " & ShiR & " " & MachiR
            End If
        End If
        On Error Resume Next
        If (Me!ì¸óÕÉ`ÉFÉbÉN = False) Then
            C_Uban = Me![Town].Column(2)
            'C_J1 = Left(èZèä, 18)                  'óLÇÍÇŒèëÇ´çûÇ›
            'C_J2 = ""                              'ÉeÅ[ÉuÉãÉfÉUÉCÉìÇ≈ãÛï∂éöóÒÇÃãñâ¬Ç
            'C_F1 = Left(JyuR, 50)                           'ÅuÇÕÇ¢ÅvÇ…ÇµÇ»Ç¢Ç∆ÉGÉâÅ[Ç…Ç»ÇÈ
            'C_F2 = ""
            C_J1 = åß
            C_J2 = és
            C_J3 = í¨
        End If
'        Me.èZèä2.SetFocus
        'ÇPí¨ñºëΩçsï\é¶ÇÃç≈èIçsÇëIëÇµÇΩèÍçáÇ‡Åuí∑Ç¢èZèäÅvÇ÷çsÇ©ÇπÇÈ
        If Len(èZèä) > 18 Or InStr(èZèä, "Åj") Then GoTo ëΩï∂éöêî
        GoTo èIóπ
    End If
    
    On Error GoTo 0

ëΩï∂éöêî:
    Dim myrs As Recordset
'2003.06.24 Access2000ÇÃÉpÉâÉÅÅ[É^ÉNÉGÉäÅ[ÇÃâ¸ë¢
    Dim strSQL As String
    Dim strYubin As String
    strYubin = C_Uban
    strSQL = "select * from U_î‘çÜ where U5 = '" & strYubin & "' or U7 = '" & strYubin & "'"
'    Set myrs = db.OpenRecordset("UQ_ïœä∑î‘çÜ", dbOpenDynaset)
    Set myrs = db.OpenRecordset(strSQL, dbOpenDynaset)
    
    Dim Add As String
    MsgBox "í¨ñºÇÃï∂éöêîÇ™ëΩÇ∑Ç¨ÇƒèZèäóìÇ…ì¸ÇËÇ´ÇÁÇ»Ç¢ÇÃÇ≈ï ï\é¶ÇµÇ‹Ç∑ÅB"
    DoCmd.Hourglass True
    With myrs
        If Left(åß, 2) = Left(és, 2) Then       'åßñºÇ∆ésñºÇ™ìØÇ∂Ç»ÇÁésÇ©ÇÁï\é¶
                Add = és
                JyuR = ShiR
            Else
                Add = åß & és
                JyuR = KenR & " " & ShiR & " "
        End If
        Do Until .EOF
            Add = Add & !í¨
            JyuR = JyuR & " " & !í¨R
            myrs.MoveNext
        Loop
    End With
    If (Me!ì¸óÕÉ`ÉFÉbÉN = False) Then
        C_J1 = Left(Add, 18)
        'C_F1 = Left(JyuR, 50)
    End If
    DoCmd.Hourglass False
    DoCmd.OpenForm "UP_í∑Ç¢èZèä"
    Forms!UP_í∑Ç¢èZèä!ëSèZèä = Add
    Forms!UP_í∑Ç¢èZèä!JyuSho = JyuR
    myrs.Close
    
èIóπ:
    Me.[åßSelect] = ""
    Me.[ésSelect] = ""
    Me.ésSelect.RowSource = "ésàÍóó"
    Me.[Town] = ""
    Me.[èZèäåüçı] = ""
    èZèäÇ©ÇÁïœä∑ÇÃèIóπ
End Sub

Private Sub Town_NotInList(NewData As String, Response As Integer)
    MsgBox "èZèäÇ™å©Ç¬Ç©ÇÁÇ»ÇØÇÍÇŒ" & Chr(10) & Chr(13) & _
            "Åuà»â∫Ç…åfç⁄Ç™Ç»Ç¢èÍçáÅvÇëIëÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
    Response = acDataErrContinue 'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶ÇπÇ∏Ç…ë±ÇØÇÈ
    'acDataErrDisplay ä˘íËÇÃÉÅÉbÉZÅ[ÉWÇ™ï\é¶Ç≥ÇÍÇ‹Ç∑ÅBì¸óÕÇ≥ÇÍÇΩílÇÕÉRÉìÉ{ É{ÉbÉNÉXÇ…í«â¡Ç≥ÇÍÇ‹ÇπÇÒÅB
    'acDataErrContinue   ä˘íËÇÃÉÅÉbÉZÅ[ÉWÇÕï\é¶Ç≥ÇÍÇ‹ÇπÇÒÅBÉJÉXÉ^ÉÄ ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈèÍçáÇ…égÇ¢Ç‹Ç∑ÅB
    'acDataErrAdded  ÉÅÉbÉZÅ[ÉWÇÕï\é¶Ç≥ÇÍÇ‹ÇπÇÒÅBì¸óÕÇ≥ÇÍÇΩílÇ™ÉRÉìÉ{ É{ÉbÉNÉXÇ…í«â¡Ç≥ÇÍÇ‹Ç∑
End Sub

Private Sub èZèäåüçı_AfterUpdate()
    Dim str As String
    Dim seaKen As String
    Dim search As String
    Dim search2 As String
    
    If (Len(Me![åßSelect]) >= 1) Then
        seaKen = "(([åß])=" & Chr(34) & CStr([åßSelect]) & Chr(34) & ")and"
    Else
        seaKen = ""
    End If
    
    If IsNull(Me![èZèäåüçı]) Then
        Exit Sub
    End If
    str = Me![èZèäåüçı]
    search = "(([és])like" & Chr(34) & Chr(42) & CStr(str) & Chr(42) & Chr(34) & ")"
    search2 = "(([í¨])like" & Chr(34) & Chr(42) & CStr(str) & Chr(42) & Chr(34) & ")"
    DoCmd.OpenForm "UP_î‘çÜàÍóó", , , seaKen & "(" & search & "or" & search2 & ")"

    Me.[èZèäåüçı] = ""
    Me.[åßSelect] = ""
    Me.[ésSelect] = ""
    Me.ésSelect.RowSource = "ésàÍóó"
    Me.[Town] = ""
    èZèäÇ©ÇÁïœä∑ÇÃèIóπ
End Sub