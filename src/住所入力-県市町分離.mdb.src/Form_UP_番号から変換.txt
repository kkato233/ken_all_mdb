Version =19
VersionRequired =19
Checksum =-2021408093
Begin Form
    DefaultView =0
    TabularCharSet =128
    TabularFamily =50
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =6803
    DatasheetFontHeight =9
    ItemSuffix =8
    Left =180
    Top =1260
    Right =7275
    Bottom =3960
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x5230c601374be240
    End
    GUID = Begin
        0x2d2beb6c66516949bb07939b8e169b52
    End
    NameMap = Begin
        0x0acc0e55000000005a5b331a5e397742af7edc8cc43a54440000000077655275 ,
        0xc3f7e440000000000000000055005f006a75f75300000000000012a6b8b428b4 ,
        0xb345a1d99034617815a7070000005a5b331a5e397742af7edc8cc43a54443a75 ,
        0x000000000000edd5233e22a3314fae47f3bda419d843070000005a5b331a5e39 ,
        0x7742af7edc8cc43a54443a755200000000000000dc00a7434bae1c4fb4bd4d6d ,
        0xef2c8ab0070000005a5b331a5e397742af7edc8cc43a54445500370000000000 ,
        0x000057262d6e5af8844bb865fe90d80ebd95070000005a5b331a5e397742af7e ,
        0xdc8cc43a54440c77000000000000c519eaa581d1b447bf214ee5c8e529570700 ,
        0x00005a5b331a5e397742af7edc8cc43a5444025e0000000000002ff1c15b2e86 ,
        0xcb4481356bfaf1e45bd6070000005a5b331a5e397742af7edc8cc43a54440789 ,
        0x70656a75f75300000000000058393f9c7ec2524384ea90e7134f7bd107000000 ,
        0x5a5b331a5e397742af7edc8cc43a54444b0065006e0052000000000000005b53 ,
        0x015903adde47945ace04907a4f63070000005a5b331a5e397742af7edc8cc43a ,
        0x5444530068006900520000000000000094e79da92df1c348b301e69ca0f5fde0 ,
        0x070000005a5b331a5e397742af7edc8cc43a5444550035000000000000007b93 ,
        0x2c32afb6dc4bbed74248f6e3b35900000000ae294175c3f7e440000000000000 ,
        0x000055005f00530075006200000000000000480d57bd85ed1045a0c40cd22a8f ,
        0xcc2b070000007b932c32afb6dc4bbed74248f6e3b3590c77000000000000b6aa ,
        0x2f7f543e1c4ea63fcb4916685d04070000007b932c32afb6dc4bbed74248f6e3 ,
        0xb359025e000000000000abb93b6a43f45346bc1d74553a7ed1f8070000005a5b ,
        0x331a5e397742af7edc8cc43a54443057df5700000000000052438ffe18266b4a ,
        0xa63fcd3b49f56e3e070000007b932c32afb6dc4bbed74248f6e3b3593057df57 ,
        0x000000000000000000000000000000000000000000000c000000050000000000 ,
        0x000000000000000000000000
    End
    DatasheetFontName ="‚l‚r ‚oƒSƒVƒbƒN"
    PrtMip = Begin
        0xa3050000a1050000a1050000a105000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0022fb180900000053c716660020fb1805010000090000002c542e01fe28da18 ,
        0x010403069c00b0040f9b8007010009009a0b3408640001000700580202000100 ,
        0x580203000000413400b58f110100000050b2e277db09e277e0ea8017908d3a01 ,
        0xf0c18f17e68a0000000000000000000000000000010000000000000001000000 ,
        0x0200000003010000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200380294041c00105a71740000000000000000000000000000000000000000 ,
        0x0000000000000000140000000100000000000100000000000000000000000100 ,
        0x0100010000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000038020000534d544a ,
        0x00000000100028027b00360036004300430036003800460034002d0035003200 ,
        0x420045002d0034003800310039002d0039004100410031002d00390039004400 ,
        0x3400420039003300390037003600390045007d000000496e70757442696e0054 ,
        0x7261793100524553444c4c00556e69726573444c4c004d656469615479706500 ,
        0x506c61696e00506170657253697a65004c4554544552004f7269656e74617469 ,
        0x6f6e00504f525452414954004475706c6578004e4f4e4500436f6c6f724d6f64 ,
        0x6500436f6c6f720050616765436f6c6f724d6f6465004e6f726d616c00506167 ,
        0x65437573746f6d48616c66746f6e6500446966667573696f6e005265736f6c75 ,
        0x74696f6e004f7074696f6e32005072696e745175616c697479004e6f726d616c ,
        0x005061676542696469725072696e74004f6e00436f6c6c617465004f46460052 ,
        0x6576657273654f72646572004f6666004a6f624e5570416c6c446f63756d656e ,
        0x7473436f6e746967756f75736c790031004a6f6250726573656e746174696f6e ,
        0x446972656374696f6e005269676874426f74746f6d00506167654272506f7374 ,
        0x6572004e6f726d616c0050616765427257617465726d61726b004e6f6e65004d ,
        0x6972726f72004f6666005061676552657665727365496d616765004f66660000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000001c0000005634444d0100000000000000 ,
        0x000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800260040000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3139322e3136382e322e31303000
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin TextBox
            BorderLineStyle =0
        End
        Begin ListBox
            BorderLineStyle =0
        End
        Begin ComboBox
            BorderLineStyle =0
        End
        Begin Section
            Height =2721
            BackColor =-2147483633
            Name ="Ú×"
            GUID = Begin
                0xb36dbf19ba05184ebc2ed66bf229da17
            End
            Begin
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextFontCharSet =128
                    Left =170
                    Top =113
                    Width =276
                    Height =227
                    FontSize =9
                    Name ="ƒ‰ƒxƒ‹0"
                    Caption ="§"
                    FontName ="‚l‚r ‚oƒSƒVƒbƒN"
                    GUID = Begin
                        0x65c5358ac88f0945938f90bf983d3afb
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextFontCharSet =128
                    Left =566
                    Top =113
                    Width =1021
                    Height =283
                    FontSize =9
                    Name ="Uban"
                    OnExit ="[Event Procedure]"
                    FontName ="‚l‚r ‚oƒSƒVƒbƒN"
                    InputMask ="\\§999\\-9999"
                    GUID = Begin
                        0x786822515126e445b5d109b6add0cd18
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    TextFontCharSet =128
                    IMEMode =1
                    ColumnCount =8
                    ListWidth =4536
                    Left =3628
                    Top =566
                    Width =2167
                    Height =284
                    FontSize =9
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";"
                        "\"10\";\"148\""
                    GUID = Begin
                        0x22f6653210ff894cb71c00bde5b37eba
                    End
                    Name ="Town"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW U_”Ô†.’¬, U_”Ô†.’¬R, U_”Ô†.U7, U_”Ô†.Œ§, U_”Ô†.s, U_”Ô†.•¡””Ô†, U_”Ô†.Ken"
                        "R, U_”Ô†.ShiR FROM U_”Ô† WHERE U_”Ô†.U7=[Uban] Or U_”Ô†.U5=[Uban]; "
                    ColumnWidths ="2268;0;0;1134;1134;1134"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="‚l‚r ‚oƒSƒVƒbƒN"
                    OnGotFocus ="[Event Procedure]"
                End
                Begin ListBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextFontCharSet =128
                    OldBorderStyle =0
                    Left =113
                    Top =566
                    Width =3345
                    FontSize =9
                    TabIndex =1
                    Name ="Œ§s"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW U_Sub!Œ§ & U_Sub!s AS Œ§s FROM U_”Ô† INNER JOIN U_Sub ON U_”Ô†.’nˆæ"
                        "=U_Sub.’nˆæ WHERE (((U_”Ô†.U5)=[Uban])) OR (((U_”Ô†.U7)=[Uban])) GROUP BY U_Sub!Œ§ & "
                        "U_Sub!s; "
                    FontName ="‚l‚r ‚oƒSƒVƒbƒN"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x6cd5b236ba7a88428d4340c89075de79
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub Uban_Exit(Cancel As Integer)
    Dim Œ§ As String, s As String
    
    If IsNull([Uban]) Then Exit Sub
    Select Case Len([Uban])
        Case 1, 2, 4, 6
            MsgBox "—X•Ö”Ô†‚ÌŒ…”‚ªŠÔˆá‚Á‚Ä‚¢‚Ü‚·B"
            Exit Sub
    End Select
    Œ§s.Requery
    If IsNull(DFirst("[’¬]", "U_”Ô†", "[U5]=[Uban] Or [U7]=[Uban]")) Then
        MsgBox "ŠY“–‚·‚é—X•Ö”Ô†‚Í—L‚è‚Ü‚¹‚ñBZŠ‚©‚ç‘{‚µ‚Ä‰º‚³‚¢B"
        Exit Sub
    Else
        Town.Requery
    End If
   
End Sub

Private Sub Town_AfterUpdate()
    Dim Œ§ As String, s As String, ’¬ As String, ZŠ As String, i As Integer
    Dim KenR As String, ShiR As String, MachiR As String, JyuR As String
    Dim IsLoad As Integer
    
    If Not IsEmpty(Town) Then
        Œ§ = Town.Column(3)
        s = Town.Column(4)
        ’¬ = Town.Column(0)
        KenR = Town.Column(6)
        ShiR = Town.Column(7)
        MachiR = Town.Column(1)
        If Left(’¬, 5) = "ˆÈ‰º‚ÉŒfÚ" Then ' ZŠ–¼‚ªˆÈ‰º‚ÉŒfÚ‚Ì‚È‚¢ê‡‚Ì
            '’¬‚Ì–¼‘O‚ğ“ü‚ê‚È‚¢
            If Left(Œ§, 2) = Left(s, 2) Then       'Œ§–¼‚Æs–¼‚ª“¯‚¶‚È‚çs‚©‚ç•\¦
                ZŠ = s
                JyuR = ShiR
            Else
                ZŠ = Œ§ & s
                JyuR = KenR & " " & ShiR
            End If
        Else
            If Left(Œ§, 2) = Left(s, 2) Then       'Œ§–¼‚Æs–¼‚ª“¯‚¶‚È‚çs‚©‚ç•\¦
                ZŠ = s & ’¬
                JyuR = ShiR & " " & MachiR
            Else
                ZŠ = Œ§ & s & ’¬
                JyuR = KenR & " " & ShiR & " " & MachiR
            End If
        End If
        C_Uban = Town.Column(2)
        'C_J1 = Left(ZŠ, 18)                  '—L‚ê‚Î‘‚«‚İ
        'C_J2 = ""                              'ƒe[ƒuƒ‹ƒfƒUƒCƒ“‚Å‹ó•¶š—ñ‚Ì‹–‰Â‚ğ
        '                                       'u‚Í‚¢v‚É‚µ‚È‚¢‚ÆƒGƒ‰[‚É‚È‚é
        'C_F1 = Left(JyuR, 50)
        'C_F2 = ""
        C_J1 = Œ§
        C_J2 = s
        C_J3 = ’¬
'        C_J2.SetFocus

                        '‚P’¬–¼‘½s•\¦‚ÌÅIs‚ğ‘I‘ğ‚µ‚½ê‡‚àu’·‚¢ZŠv‚Ös‚©‚¹‚é
        If Len(ZŠ) > 18 Or InStr(ZŠ, "j") Then GoTo ‘½•¶š”
        
        DoCmd.Close
        Exit Sub
    End If


‘½•¶š”:
    Dim db As Database, myrs As Recordset
    Set db = CurrentDb
'2003.06.24 Access2000‚Ìƒpƒ‰ƒ[ƒ^ƒNƒGƒŠ[‚Ì‰ü‘¢
    Dim strSQL As String
    Dim strYubin As String
    strYubin = C_Uban
    strSQL = "select * from U_”Ô† where U5 = '" & strYubin & "' or U7 = '" & strYubin & "'"
'    Set myrs = db.OpenRecordset("UQ_•ÏŠ·”Ô†", dbOpenDynaset)
    Set myrs = db.OpenRecordset(strSQL, dbOpenDynaset)

    
    Dim Add As String
    MsgBox "’¬–¼‚Ì•¶š”‚ª‘½‚·‚¬‚ÄZŠ—“‚É“ü‚è‚«‚ç‚È‚¢‚Ì‚Å•Ê•\¦‚µ‚Ü‚·B"
    DoCmd.Hourglass True
    With myrs
    If Left(!Œ§, 2) = Left(!s, 2) Then       'Œ§–¼‚Æs–¼‚ª“¯‚¶‚È‚çs‚©‚ç•\¦
            Add = !s
            JyuR = !ShiR
        Else
            Add = !Œ§ & !s
            JyuR = !KenR & " " & !ShiR
    End If
    Do Until .EOF
        Add = Add & !’¬
        JyuR = JyuR & " " & !’¬R
        myrs.MoveNext
    Loop
    End With
    DoCmd.Hourglass False
    DoCmd.OpenForm "UP_’·‚¢ZŠ"
    Forms!UP_’·‚¢ZŠ!‘SZŠ = Add
    Forms!UP_’·‚¢ZŠ!JyuSho = JyuR
    
    DoCmd.Close A_FORM, "UP_”Ô†‚©‚ç•ÏŠ·"

End Sub

Private Sub Town_GotFocus()
    Town.Dropdown
End Sub

Private Sub ZŠ‚©‚ç•ÏŠ·_Click()
    DoCmd.Close
    DoCmd.OpenForm "UP_ZŠ‚©‚ç•ÏŠ·"
End Sub

Private Sub •Â_Click()
    DoCmd.Close
End Sub

Private Sub Œ§s_Click()
    'SELECT DISTINCTROW U_”Ô†.’¬, U_”Ô†.’¬R, U_”Ô†.U7, U_”Ô†.Œ§, U_”Ô†.s, U_”Ô†.•¡””Ô†, U_”Ô†.KenR, U_”Ô†.ShiR FROM U_”Ô† WHERE ((([Œ§] & [s])=[Œ§s]) AND ((U_”Ô†.U5)=[Uban])) OR (((U_”Ô†.U7)=[UBan]) AND (([Œ§] & [s])=[Œ§s]));
    Dim setItem As String
    Dim Uban As String
    
    'setItem = Œ§s.Value
    
    'Town.RowSource = "SELECT DISTINCTROW U_”Ô†.’¬, U_”Ô†.’¬R, U_”Ô†.U7, U_”Ô†.Œ§, U_”Ô†.s, U_”Ô†.•¡””Ô†, U_”Ô†.KenR, U_”Ô†.ShiR FROM U_”Ô† " & _
        " WHERE ((([Œ§] & [s])=" & Chr(22) & setItem & Chr(22) & " ) AND ((U_”Ô†.U5)=[Uban])) " & _
        " OR (((U_”Ô†.U7)=[UBan]) AND (([Œ§] & [s])=" & Chr(22) & setItem & Chr(22) & ")"
    
    'Town.Requery
    
End Sub