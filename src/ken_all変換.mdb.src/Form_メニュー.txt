Version =19
VersionRequired =19
Checksum =2021401256
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularCharSet =128
    TabularFamily =50
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =8850
    DatasheetFontHeight =11
    ItemSuffix =31
    Left =1890
    Top =345
    Right =10740
    Bottom =4920
    DatasheetGridlinesColor =15062992
    RecSrcDt = Begin
        0xd71f4e85af6ee340
    End
    DatasheetFontName ="ＭＳ Ｐゴシック"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x005250220060021278075522e70000007065091ac600000000000000a5000000 ,
        0x010403069c0050140f9b8007010009009a0b3408640001000700580202000100 ,
        0x5802030000004134005b60000000000034000000a05bc0191800000000005101 ,
        0x5000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200c80024032c113f5d7b7e0000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000050001000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000c8000000534d544a ,
        0x000000001000b8007b00300038003400460030003100460041002d0045003600 ,
        0x330034002d0034004400370037002d0038003300450045002d00300037003400 ,
        0x3800310037004300300033003500380031007d000000524553444c4c00556e69 ,
        0x726573444c4c00506170657253697a65004134004f7269656e746174696f6e00 ,
        0x504f525452414954005265736f6c7574696f6e005265734f7074696f6e310043 ,
        0x6f6c6f724d6f646500436f6c6f72000000000000000000000000000000000000 ,
        0x2c1100005634444d01000000000000009c0a70221c000000ec00000003000000 ,
        0xfa014f0834e6774d83ee074817c03581d00000004c0000000300000000080000 ,
        0x000000000000000003000000000800002a000000000800000300000040000000 ,
        0x560000000010000044006f00630075006d0065006e0074005500730065007200 ,
        0x500061007300730077006f0072006400000044006f00630075006d0065006e00 ,
        0x74004f0077006e0065007200500061007300730077006f007200640000004400 ,
        0x6f00630075006d0065006e007400430072007900700074005300650063007500 ,
        0x7200690074007900000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000504f525450524f4d5054 ,
        0x3a0000000000
    End
    OnLoad ="[Event Procedure]"
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            TextFontCharSet =128
            FontSize =11
            FontName ="ＭＳ Ｐゴシック"
        End
        Begin CommandButton
            TextFontCharSet =128
            Width =1701
            Height =435
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="ＭＳ Ｐゴシック"
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            FELineBreak = NotDefault
            TextFontCharSet =128
            BorderLineStyle =0
            Width =1701
            Height =270
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="ＭＳ Ｐゴシック"
        End
        Begin Section
            Height =4592
            Name ="詳細"
            GUID = Begin
                0x1b40d62d4351d942921628f79cf6d048
            End
            Begin
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =283
                    Width =2940
                    Height =285
                    FontSize =13
                    FontWeight =700
                    ForeColor =16711680
                    Name ="ラベル0"
                    Caption ="最新 郵便番号辞書作成"
                    GUID = Begin
                        0x20739875478f034da73ab10d9cd69931
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =1916
                    Top =1520
                    Width =5901
                    Name ="テキスト10"
                    GUID = Begin
                        0xdec21d78069fcf44815154b038c2226f
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =776
                    Top =1516
                    Width =1080
                    Height =240
                    Name ="ラベル13"
                    Caption ="フォルダ名"
                    GUID = Begin
                        0xed6355751f229e4ea6f162e379b1fee6
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =1179
                    Top =1974
                    TabIndex =1
                    Name ="チェック14"
                    GUID = Begin
                        0xc0d7b145e38c484c9ff3893203e99e01
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1406
                            Top =1951
                            Width =3330
                            Height =270
                            Name ="ラベル15"
                            Caption ="住所の読みがなを全角に変換する"
                            GUID = Begin
                                0xf61d63af495db44bab04e8f572754774
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =7873
                    Top =1474
                    Width =385
                    Height =344
                    TabIndex =2
                    Name ="コマンド16"
                    Caption ="..."
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xd80a2a5d3a79d146bce1868543288551
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =2713
                    Top =2483
                    TabIndex =3
                    Name ="コマンド17"
                    Caption ="取り込み"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x2b6edb5ce311e142995c68769ce1b2f9
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =566
                    Top =2594
                    Width =2100
                    Height =240
                    Name ="ラベル18"
                    Caption ="準備ができたら、この"
                    GUID = Begin
                        0x9a76fe7709c72744a4033560ad71a0cc
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =4646
                    Top =2534
                    Width =4140
                    Height =240
                    Name ="ラベル22"
                    Caption ="ボタンをクリックして 完了メッセージが"
                    GUID = Begin
                        0x8ddd3f79c92c8b43a1b8e3c1d378a05d
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =510
                    Top =453
                    Width =7725
                    Height =240
                    Name ="ラベル23"
                    Caption ="日本郵便から 郵便番号データ (lzh形式) を ダウンロードして 展開してください。"
                    GUID = Begin
                        0x474ffaf6d86f2541bff106e43aa4b870
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =510
                    Top =3750
                    Width =7725
                    Height =285
                    FontWeight =700
                    ForeColor =32768
                    Name ="ラベル24"
                    Caption ="この「郵便番号辞書作成」 は フリーウェアです。"
                    GUID = Begin
                        0x745e64de3f078648a8e1573d5dd5863a
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =4631
                    Top =2879
                    Width =4125
                    Height =285
                    Name ="ラベル25"
                    Caption ="出るまで、しばらく待ちます。"
                    GUID = Begin
                        0xcfaad84727757749ad4c7d5480e40835
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =623
                    Top =3174
                    Width =7755
                    Height =390
                    FontWeight =700
                    ForeColor =16711680
                    Name ="ラベルメッセージ"
                    Caption ="メッセージ"
                    GUID = Begin
                        0xf97630f5b5578d40b7a799af9d6240d5
                    End
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =510
                    Top =4138
                    Width =4035
                    Height =285
                    ForeColor =12673797
                    Name ="ラベル29"
                    Caption ="https://github.com/kkato233/ken_all_mdb"
                    HyperlinkAddress ="https://github.com/kkato233/ken_all_mdb"
                    GUID = Begin
                        0x6224a54a554b9d469f7cf2ce26a694c4
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =510
                    Top =793
                    Width =7725
                    Height =240
                    Name ="ラベル12"
                    Caption ="展開した KEN_ALL.csv JIGYOSYO.csv を同じディレクトリに入れてください。"
                    GUID = Begin
                        0x469044d4eb5e744cb369c059f7243a23
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontFamily =50
                    Left =510
                    Top =1133
                    Width =7725
                    Height =240
                    Name ="ラベル30"
                    Caption ="そのディレクトリを指定したのち「取り込み」ボタンをクリックしてください。"
                    GUID = Begin
                        0x55bc1ecfa7ba8f48ba5536fe96a66291
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'2009.05.11 ２００９年４月の日本郵便のデータは 企業郵便番号に 地域の郵便番号と一緒の番号があるので対処
'

Option Compare Database

Private Sub Form_Load()
    Me.チェック14.Value = True
End Sub

Private Sub コマンド16_Click()

    ' Microsoft Office 11.0 Object Library への参照設定が必要です。
    Dim foldername As String
   
    Dim fDialog As Office.FileDialog
    
    ' ファイル ダイアログ ボックスを設定します。
    Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)

    With fDialog
        'ダイアログのタイトルを設定
        .Title = "ken_all.csv や jigyosyo.csv ファイルのあるフォルダを指定してください。"
        'ダイアログを表示
      
        .Filters.Clear
        '.Filters.Add "CSV ファイル", "*.CSV"

        If .Show = True Then
            foldername = Trim(.SelectedItems.Item(1))
        Else
            foldername = ""
        End If
    End With
    
    Me.テキスト10.Value = foldername
    
End Sub

Private Sub ClearMessage()
    Me.ラベルメッセージ.Caption = ""
    Me.ラベルメッセージ.Visible = True
    Me.Repaint
End Sub

Private Sub AddMessage(msg As String)
    Me.ラベルメッセージ.Caption = msg
    Me.Repaint
End Sub


Private Sub AddStatusChar(c As String)
    Me.ラベルメッセージ.Caption = Me.ラベルメッセージ.Caption & c
    Me.Repaint
End Sub


Private Sub コマンド17_Click()
    On Error GoTo error_exec
   
    Me.テキスト10.SetFocus
    Me.コマンド17.Enabled = False
    
    ClearMessage
    
    'CSVファイルの確認
    Dim ken_all_csv As String
    Dim jigyosyo_csv As String
    Dim sql As String
    Dim input_file As String
    
    
    ken_all_csv = Me.テキスト10.Value & "\ken_all.csv"
    jigyosyo_csv = Me.テキスト10.Value & "\jigyosyo.csv"
    
    If (Not FileExists(ken_all_csv)) And (Not FileExists(jigyosyo_csv)) Then
        MsgBox "郵便番号データ (csv ファイル) がありません。"
        Exit Sub
    End If
    
    DoCmd.SetWarnings False
    
    AddMessage "取り込みを開始します。終了までしばらくお待ちください...。"
    
    If FileExists(ken_all_csv) Then
        AddMessage "住所の郵便番号(ken_all.csv) 取り込み開始"
        
        DoCmd.RunSQL "DELETE * FROM U_番号"
        DoCmd.TransferText acImportDelim, "ken_all定義", "U_番号", ken_all_csv, False

        AddMessage "U_SUBテーブル作成中"
        DoCmd.RunSQL "delete * from U_Sub"
       
        sql = "INSERT INTO U_Sub ( 地域, KenR, ShiR, 県, 市 )" & _
                " SELECT U_番号.地域, U_番号.KenR, U_番号.ShiR, U_番号.県, U_番号.市" & _
                " FROM U_番号 " & _
                " GROUP BY U_番号.地域, U_番号.KenR, U_番号.ShiR, U_番号.県, U_番号.市;"
        DoCmd.RunSQL sql
    
        '半角を全角に変換する。
        If Me.チェック14.Value = True Then
            AddMessage "半角ｶﾀｶﾅを全角ひらがなに変換中（住所データ）"
            data_han_to_zen_U_SUB
            data_han_to_zen_U_番号
        End If
        
        input_file = "住所郵便番号"
        
    End If
    
    If FileExists(jigyosyo_csv) Then
        AddMessage "企業の郵便番号(jigyosyo.csv) 取り込み開始"
        
        DoCmd.RunSQL "DELETE * FROM U_企業"
        DoCmd.TransferText acImportDelim, "jigyosyo定義", "U_企業", jigyosyo_csv, False

        '半角を全角に変換する。
        If Me.チェック14.Value = True Then
            data_han_to_zen_U_企業
        End If
    
        input_file = input_file & " 企業の郵便番号"
    End If

    AddMessage "U7_県対応表 テーブル作成中"
    data_add_U7_県対応表
        
    AddMessage "郵便番号データの取り込みが完了しました。"
    
    MsgBox input_file & "の取り込みが完了しました。"
        
exit_sub:
    DoCmd.SetWarnings True
    Me.コマンド17.Enabled = True
    
    Exit Sub
    
error_exec:
    MsgBox "取り込み処理中にエラーが発生しました。：" & Err.Description
    Resume exit_sub
    
End Sub


Private Sub data_add_U7_県対応表()

    DoCmd.RunSQL "DELETE * FROM U7_県対応表"

    '-- 考え方 U7 １つにつき１つだけ「県」と「地域」を抽出する。
    Dim rs As New ADODB.Recordset
    Dim sql As String
    sql = "select U7,県,地域 from U_番号 " & _
        " union select U7,県,地域 from U_企業 order by U7,地域"
    
    rs.Open sql, CurrentProject.Connection, adOpenForwardOnly
    
    Dim wrs As Recordset
    Set wrs = CurrentDb.OpenRecordset("U7_県対応表")
    Dim u7 As String
    
    u7 = ""
    Dim n As Integer
    n = 0
    
    While Not rs.EOF
        If rs!u7 <> u7 Then
            wrs.AddNew
            wrs!u7 = rs!u7
            wrs!県 = rs!県
            wrs!地域 = rs!地域
            wrs.Update
            u7 = rs!u7
        Else
            '同じ７桁郵便番号の場合はスキップする。
        End If
        
        rs.MoveNext
    Wend

    rs.Close
End Sub

Private Sub data_han_to_zen_U_SUB()
    Dim rs As Recordset
    Dim ken_r As String
    Dim ken_h As String
    Dim s As String
    Dim n As Integer
    
    Set rs = CurrentDb.OpenRecordset("U_SUB")
    
    n = 0
    While Not rs.EOF

        rs.Edit
        'KEN_R は同じ文字がくる可能性が高いので ken_h を再利用する。
        s = rs!KenR
        If s = ken_r Then
            rs!KenR = ken_h
        Else
            ken_r = rs!KenR
            ken_h = StrConv(ken_r, vbWide + vbHiragana)
            rs!KenR = ken_h
        End If
        
        rs!ShiR = StrConv(rs!ShiR, vbWide + vbHiragana)
        rs.Update
        rs.MoveNext
        
        n = n + 1
        If n > 5000 Then
            n = 0
            AddStatusChar "+"
        End If

    Wend
    
End Sub

Private Sub data_han_to_zen_U_企業()
'テーブルに取り込まれた半角を全角に変換する。
    Set rs = CurrentDb.OpenRecordset("U_企業")
    Dim n As Integer
    
    While Not rs.EOF
        rs.Edit
        rs!事業所名かな = StrConv(rs!事業所名かな, vbWide + vbHiragana)
        rs.Update
        rs.MoveNext
        
        n = n + 1
        If n > 5000 Then
            n = 0
            AddStatusChar "+"
        End If

    Wend
    
End Sub


Private Sub data_han_to_zen_U_番号()
    'U_SUB が正しく半角から全角に変換されているのが前提
    
    Dim sub_rs As New ADODB.Recordset
    Dim sub_num As String
    Dim rs As Recordset
    Dim s As String
    Dim total_n As Long
    Dim now_n As Integer
    Dim n As Integer
    
    Set rs = CurrentDb.OpenRecordset("U_番号")
    sub_rs.Open "select * from U_SUB where 0 = 1", CurrentProject.Connection
    
    n = 0
    While Not rs.EOF
        rs.Edit
        If (sub_num <> rs!地域) Then
            sub_num = rs!地域
            sub_rs.Close
            'Set sub_rs = CurrentDb.OpenRecordset("select * from U_SUB where 地域 = '" & sub_num & "'", dbOpenSnapshort)
            sub_rs.Open "select * from U_SUB where 地域 = '" & sub_num & "'", CurrentProject.Connection
        End If
        rs!KenR = sub_rs!KenR
        rs!ShiR = sub_rs!ShiR
        rs!町R = StrConv(rs!町R, vbWide + vbHiragana)
        rs.Update
        rs.MoveNext
        
        n = n + 1
        If n > 5000 Then
            n = 0
            AddStatusChar "+"
        End If

    Wend

End Sub

Public Function FileExists(path As String)
    Dim fso As New FileSystemObject
    
    If fso.FileExists(path) Then
        FileExists = True
    Else
        FileExists = False
    End If
    
End Function